/**
 * Created by luodianlei on 2017/12/16.
 */
(function(){var Tool={getRandom:function(min,max){return Math.floor(Math.random()*(max-min+1))+min}};window.Tool=Tool})();(function(){var container;function Food(options){options=options||{};this.width=options.width||20;this.height=options.height||20;this.color=options.color||"green";this.x=options.x||0;this.y=options.y||0}Food.prototype.render=function(box){if(container){box.removeChild(container)}var div=document.createElement("div");container=div;div.style.width=this.width+"px";div.style.height=this.height+"px";div.style.backgroundColor=this.color;div.style.position="absolute";box.appendChild(div);this.x=Tool.getRandom(0,box.offsetWidth/div.offsetWidth-1)*div.offsetWidth;this.y=Tool.getRandom(0,box.offsetHeight/div.offsetHeight-1)*div.offsetHeight;div.style.left=this.x+"px";div.style.top=this.y+"px"};window.Food=Food})();(function(){var arr=[];function Snake(options){options=options||{};this.width=options.width||20;this.height=options.height||20;this.direction=options.direction||"right";this.body=[{x:3,y:2,color:"red"},{x:2,y:2,color:"blue"},{x:1,y:2,color:"blue"}]}Snake.prototype.render=function(box){remove(box);for(var i=0;i<this.body.length;i++){var div=document.createElement("div");arr.push(div);div.style.width=this.width+"px";div.style.height=this.height+"px";div.style.backgroundColor=this.body[i].color;div.style.position="absolute";div.style.left=this.body[i].x*this.width+"px";div.style.top=this.body[i].y*this.height+"px";box.appendChild(div)}};function remove(box){for(var i=0,leng=arr.length;i<leng;i++){box.removeChild(arr[0]);arr.splice(0,1)}}Snake.prototype.move=function(){for(var i=this.body.length-1;i>0;i--){this.body[i].x=this.body[i-1].x;this.body[i].y=this.body[i-1].y}switch(this.direction){case"left":this.body[0].x-=1;break;case"right":this.body[0].x+=1;break;case"top":this.body[0].y-=1;break;case"bottom":this.body[0].y+=1;break}};window.Snake=Snake})();(function(){var that;var id;var map;function Game(){this.snake=new Snake();this.food=new Food()}Game.prototype.start=function(box){this.food.render(box);this.snake.render(box);this.map=box;that=this;autoMove();document.onkeydown=function(e){console.log(e.keyCode);switch(e.keyCode){case 37:if(that.snake.direction==="right"){return}that.snake.direction="left";break;case 38:if(that.snake.direction==="bottom"){return}that.snake.direction="top";break;case 39:if(that.snake.direction==="left"){return}that.snake.direction="right";break;case 40:if(that.snake.direction==="top"){return}that.snake.direction="bottom";break}}};function autoMove(){id=setInterval(function(){that.snake.move();var head=that.snake.body[0];var maxX=that.map.offsetWidth/that.snake.width-1;var maxY=that.map.offsetHeight/that.snake.height-1;if(head.x<0||head.y<0||head.x>maxX||head.y>maxY){clearInterval(id);alert("game over");return}if(head.x*that.snake.width===that.food.x&&head.y*that.snake.height===that.food.y){that.food.render(that.map);var last=that.snake.body[that.snake.body.length-1];that.snake.body.push({x:last.x,y:last.y,color:last.color})}that.snake.render(that.map)},150)}window.Game=Game})();(function(){var box=document.getElementById("box");var game=new Game();game.start(box)})();